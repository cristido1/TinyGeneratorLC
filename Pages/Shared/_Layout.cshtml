<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - TinyGenerator</title>
    <link href="~/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/lib/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
    <link href="~/lib/datatables/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
    <link href="~/lib/datatables/css/buttons.bootstrap5.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/sidebar.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <style>
        /* Slightly darker column headers for DataTables */
        table.dataTable thead th {
            color: #111827; /* slate-900, slightly darker */
            font-weight: 600;
        }
    </style>
    @await RenderSectionAsync("Styles", required: false)
</head>
<body class="has-sidebar">
    <!-- Mobile menu button -->
    <button class="mobile-menu-btn d-md-none" aria-label="Apri menu">
        <i class="bi bi-list"></i>
    </button>
    
    <!-- Sidebar overlay for mobile -->
    <div class="sidebar-overlay"></div>
    
    <!-- Collapsible sidebar navigation -->
    <nav class="app-sidebar">
        <div class="sidebar-header">
            <a href="/" class="sidebar-brand">
                <i class="bi bi-lightning-fill"></i>
                <span class="sidebar-brand-text">TinyGenerator</span>
            </a>
            <button class="sidebar-toggle" aria-label="Riduci menu">
                <i class="bi bi-chevron-left"></i>
            </button>
        </div>
        
        <div class="sidebar-nav">
            <div class="sidebar-section">
                <div class="sidebar-section-title">Principale</div>
                <a href="/" title="Home"><i class="bi bi-house"></i><span>Home</span></a>
                <a asp-page="/Genera" title="Genera storia"><i class="bi bi-pencil-square"></i><span>Genera storia</span></a>
                <a asp-page="/Stories/Index" title="Storie salvate"><i class="bi bi-journal-text"></i><span>Storie salvate</span></a>
                <a asp-page="/Chat" title="Chat"><i class="bi bi-chat-dots"></i><span>Chat</span></a>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Monitoraggio</div>
                <a asp-page="/Logs/Index" title="Logs"><i class="bi bi-list-check"></i><span>Logs</span></a>
                <a asp-page="/ChatLog/Index" title="Chat Log"><i class="bi bi-chat-left-text"></i><span>Chat Log</span></a>
                <a asp-page="/OllamaMonitor" title="Ollama Monitor"><i class="bi bi-cpu"></i><span>Ollama Monitor</span></a>
                <a asp-page="/StoriesStatus/Index" title="Stories Status"><i class="bi bi-flag"></i><span>Stories Status</span></a>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Configurazione</div>
                <a asp-page="/Models/Index" title="Modelli"><i class="bi bi-diagram-3"></i><span>Modelli</span></a>
                <a asp-page="/Agents/Index" title="Agents"><i class="bi bi-people"></i><span>Agents</span></a>
                <a asp-page="/Agents/FallbackModels" title="Fallback models"><i class="bi bi-shuffle"></i><span>Fallback models</span></a>
                <a asp-page="/Series/Index" title="Serie"><i class="bi bi-collection"></i><span>Serie</span></a>
                <a asp-page="/TaskTypes/Index" title="Task Types"><i class="bi bi-tags"></i><span>Task Types</span></a>
                <a asp-page="/StepTemplates/Index" title="Step Templates"><i class="bi bi-list-ol"></i><span>Step Templates</span></a>
                <a asp-page="/PlannerMethods" title="Metodi Pianificazione"><i class="bi bi-diagram-2"></i><span>Metodi Pianificazione</span></a>
                <a asp-page="/TipoPlanning" title="Tipi Planning"><i class="bi bi-signpost-2"></i><span>Tipi Planning</span></a>
                <a asp-page="/Roles/Index" title="Roles"><i class="bi bi-people"></i><span>Roles</span></a>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-section-title">Narrative Engine</div>
                <a asp-page="/NarrativeProfiles/Index" title="Unified Narrative Engine"><i class="bi bi-journal-bookmark"></i><span>Narrative Engine Profiles</span></a>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-section-title">Admin</div>
                <a asp-page="/Admin" title="Pannello Admin"><i class="bi bi-graph-up"></i><span>Admin</span></a>
                <a asp-page="/TestDefinitions/Index" title="Test Definitions"><i class="bi bi-list-ul"></i><span>Test Definitions</span></a>
                <a asp-page="/TtsVoices/Index" title="TTS Voices"><i class="bi bi-megaphone"></i><span>TTS Voices</span></a>
            </div>
        </div>
    </nav>

    <div class="main-content">
        @{
            var pageDescription = ViewData["PageDescription"] as string ?? string.Empty;
        }
        <div class="d-flex align-items-center mb-3 justify-content-between">
            <h4 class="mb-0">@ViewData["Title"]</h4>
            @if (!string.IsNullOrWhiteSpace(pageDescription))
            {
                <small id="pageDescriptionText" class="text-muted ms-3" style="font-size:0.95rem; opacity:0.9;">@pageDescription</small>
            }
        </div>
        @RenderBody()
    </div>
    
    <!-- Shared JS -->
    <script src="~/lib/jquery/jquery.min.js"></script>
    <script src="~/lib/datatables/js/jquery.dataTables.min.js"></script>
    <script src="~/lib/datatables/js/dataTables.bootstrap5.min.js"></script>
    <script src="~/lib/datatables/js/dataTables.buttons.min.js"></script>
    <script src="~/lib/datatables/js/buttons.bootstrap5.min.js"></script>
    <script src="~/lib/datatables/js/buttons.colVis.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/signalr/signalr.min.js"></script>
    <script src="~/js/sidebar.js" asp-append-version="true"></script>
    <!-- Command panel for active commands -->
    <script src="~/js/command-panel.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
