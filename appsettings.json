{
    "LlamaCpp":  {
                     "Root":  "C:\\llama.cpp.13.1",
                     "Models":  "C:\\llama.cpp.13.1\\models",
                     "ServerExe":  "C:\\llama.cpp.13.1\\llama-server.exe",
                     "Host":  "127.0.0.1",
                     "Port":  11436,
                     "RestartPolicy":  "kill",
                     "GpuLayers":  0,
                     "Device":  "CUDA0",
                     "CudaBinPath":  "C:\\llama.cpp.13.1;C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v12.4\\bin"
                 },
    "Logging":  {
                    "LogLevel":  {
                                     "Default":  "Information",
                                     "Microsoft.AspNetCore":  "Warning"
                                 }
                },
    "AllowedHosts":  "*",
    "AudioCraft":  {
                       "ForceCpu":  false
                   },
    "AudioMix":  {
                     "MusicVolume":  3,
                     "BackgroundSoundsVolume":  0,
                     "FxSourdsVolume":  6,
                     "VoiceVolume":  7
                 },
    "Serie":  {
                  "Bible":  {
                                "MaxAttempts":  3,
                                "RetryDelaySeconds":  2,
                                "DiagnoseOnFinalFailure":  true
                            },
                  "Characters":  {
                                     "MaxAttempts":  3,
                                     "RetryDelaySeconds":  2,
                                     "DiagnoseOnFinalFailure":  true
                                 },
                  "Episodes":  {
                                   "MaxAttempts":  3,
                                   "RetryDelaySeconds":  2,
                                   "DiagnoseOnFinalFailure":  true
                               },
                  "Validator":  {
                                    "MaxAttempts":  3,
                                    "RetryDelaySeconds":  2,
                                    "DiagnoseOnFinalFailure":  true
                                }
              },
    "Debug":  {
                  "EnableOutboundGeneration":  false
              },
    "Database":  {
                     "EnableEfMigrations":  false,
                     "EnableManualMigrations":  false
                 },
    "Commands":  {
                     "Defaults":  {
                                      "Policy":  {
                                                     "MaxAttempts":  3,
                                                     "RetryDelayBaseSeconds":  2,
                                                     "RetryDelayMaxSeconds":  30,
                                                     "ExponentialBackoff":  true,
                                                     "RetryOnFailureResult":  false,
                                                     "RetryOnException":  true
                                                 },
                                      "ResponseValidation":  {
                                                                 "Enabled":  true,
                                                                 "MaxRetries":  2,
                                                                 "AskFailureReasonOnFinalFailure":  true,
                                                                 "EnableFallback":  true,
                                                                 "EnableCheckerByDefault":  true,
                                                                 "SkipRoles":  [
                                                                                   "response_checker",
                                                                                   "log_analyzer"
                                                                               ],
                                                                 "Rules":  [
                                                                               {
                                                                                   "Id":  1,
                                                                                   "Text":  "Non fare domande all\u0027utente e non chiedere chiarimenti."
                                                                               },
                                                                               {
                                                                                   "Id":  2,
                                                                                   "Text":  "Non anticipare step futuri o output non richiesti."
                                                                               },
                                                                               {
                                                                                   "Id":  3,
                                                                                   "Text":  "Rispetta rigorosamente il formato richiesto (se presente)."
                                                                               },
                                                                               {
                                                                                   "Id":  4,
                                                                                   "Text":  "Risposta completa: non troncare e non lasciare TODO."
                                                                               }
                                                                           ]
                                                             }
                                  },
                     "ByCommand":  {
                                       "BatchSummarizeStories":  {
                                                                     "Policy":  {
                                                                                    "MaxAttempts":  1
                                                                                }
                                                                 },
                                       "SummarizeStory":  {
                                                              "Policy":  {
                                                                             "MaxAttempts":  1
                                                                         }
                                                          },
                                       "TransformStoryRawToTagged":  {
                                                                         "Policy":  {
                                                                                        "MaxAttempts":  1
                                                                                    },
                                                                         "Tuning":  {
                                                                                        "AutolaunchNextCommand":  true,
                                                                                        "MinTokensPerChunk":  1000,
                                                                                        "MaxTokensPerChunk":  2000,
                                                                                        "TargetTokensPerChunk":  1500,
                                                                                        "OverlapTokens":  150,
                                                                                        "MaxAttemptsPerChunk":  4,
                                                                                        "FormatterV2CorrectionRetries":  3,
                                                                                        "MaxOverlapChars":  8000,
                                                                                        "MinTagsPerChunkRequirement":  3,
                                                                                        "RetryDelayBaseSeconds":  2
                                                                                    }
                                                                     },
                                       "ExecuteMultiStepTask":  {
                                                                    "Policy":  {
                                                                                   "MaxAttempts":  1
                                                                               }
                                                                },
                                       "StartMultiStepStory":  {
                                                                   "Policy":  {
                                                                                  "MaxAttempts":  1
                                                                              }
                                                               },
                                       "FullStoryPipeline":  {
                                                                 "Policy":  {
                                                                                "MaxAttempts":  1
                                                                            },
                                                                 "Tuning":  {
                                                                                "AudioPipelineTotalSteps":  9
                                                                            }
                                                             },
                                       "full_story_pipeline":  {
                                                                   "Policy":  {
                                                                                  "MaxAttempts":  1
                                                                              }
                                                               },
                                       "GenerateSeriesEpisode":  {
                                                                     "Policy":  {
                                                                                    "MaxAttempts":  3
                                                                                }
                                                                 },
                                       "series_episode":  {
                                                              "Policy":  {
                                                                             "MaxAttempts":  1
                                                                         }
                                                          },
                                       "story_multi_step":  {
                                                                "Policy":  {
                                                                               "MaxAttempts":  1
                                                                           }
                                                            },
                                       "GenerateNextChunk":  {
                                                                 "Policy":  {
                                                                                "MaxAttempts":  2,
                                                                                "RetryDelayBaseSeconds":  2,
                                                                                "RetryOnException":  true
                                                                            },
                                                                 "Tuning":  {
                                                                                "ContextTailChars":  800,
                                                                                "MaxAttempts":  4
                                                                            }
                                                             },
                                       "StateDrivenNextChunk":  {
                                                                    "Policy":  {
                                                                                   "MaxAttempts":  2,
                                                                                   "RetryDelayBaseSeconds":  2,
                                                                                   "RetryOnException":  true
                                                                               }
                                                                },
                                       "StateDrivenEpisodeAuto":  {
                                                                      "Policy":  {
                                                                                     "MaxAttempts":  2,
                                                                                     "RetryDelayBaseSeconds":  2,
                                                                                     "RetryOnException":  true
                                                                                 }
                                                                  },
                                       "state_driven_series_episode":  {
                                                                           "Policy":  {
                                                                                          "MaxAttempts":  1
                                                                                      }
                                                                       },
                                       "state_driven_series_episode_auto":  {
                                                                                "Policy":  {
                                                                                               "MaxAttempts":  1
                                                                                           }
                                                                            },
                                       "state_driven_next_chunk":  {
                                                                       "Policy":  {
                                                                                      "MaxAttempts":  2,
                                                                                      "RetryDelayBaseSeconds":  2,
                                                                                      "RetryOnException":  true
                                                                                  }
                                                                   },
                                       "bulk_evaluate":  {
                                                             "Policy":  {
                                                                            "MaxAttempts":  3
                                                                        }
                                                         },
                                       "bulk_evaluate_story":  {
                                                                   "Policy":  {
                                                                                  "MaxAttempts":  3
                                                                              }
                                                               },
                                       "bulk_evaluate_coherence":  {
                                                                       "Policy":  {
                                                                                      "MaxAttempts":  3
                                                                                  }
                                                                   },
                                       "evaluate_coherence":  {
                                                                  "Policy":  {
                                                                                 "MaxAttempts":  3
                                                                             }
                                                              },
                                       "evaluate_action_pacing":  {
                                                                      "Policy":  {
                                                                                     "MaxAttempts":  3
                                                                                 }
                                                                  },
                                       "clone_revised_story":  {
                                                                   "Policy":  {
                                                                                  "MaxAttempts":  1
                                                                              }
                                                               },
                                       "test_tts_schema":  {
                                                               "Policy":  {
                                                                              "MaxAttempts":  1
                                                                          }
                                                           },
                                       "mix_final_audio":  {
                                                               "Policy":  {
                                                                              "MaxAttempts":  1
                                                                          }
                                                           },
                                       "prepare_tts_schema":  {
                                                                  "Policy":  {
                                                                                 "MaxAttempts":  1
                                                                             }
                                                              },
                                       "normalize_characters":  {
                                                                    "Policy":  {
                                                                                   "MaxAttempts":  1
                                                                               }
                                                                },
                                       "normalize_sentiments":  {
                                                                    "Policy":  {
                                                                                   "MaxAttempts":  1
                                                                               }
                                                                },
                                       "delete_final_mix":  {
                                                                "Policy":  {
                                                                               "MaxAttempts":  1
                                                                           }
                                                            },
                                       "delete_music":  {
                                                            "Policy":  {
                                                                           "MaxAttempts":  1
                                                                       }
                                                        },
                                       "delete_fx":  {
                                                         "Policy":  {
                                                                        "MaxAttempts":  1
                                                                    }
                                                     },
                                       "delete_ambience":  {
                                                               "Policy":  {
                                                                              "MaxAttempts":  1
                                                                          }
                                                           },
                                       "delete_tts":  {
                                                          "Policy":  {
                                                                         "MaxAttempts":  1
                                                                     }
                                                      },
                                       "delete_story_tagged":  {
                                                                   "Policy":  {
                                                                                  "MaxAttempts":  1
                                                                              }
                                                               },
                                       "add_voice_tags_to_story":  {
                                                                       "Policy":  {
                                                                                      "MaxAttempts":  3
                                                                                  }
                                                                   },
                                       "regen_ambient_tags":  {
                                                                  "Policy":  {
                                                                                 "MaxAttempts":  3
                                                                             }
                                                              },
                                       "regen_fx_tags":  {
                                                             "Policy":  {
                                                                            "MaxAttempts":  3
                                                                        }
                                                         },
                                       "regen_music_tags":  {
                                                                "Policy":  {
                                                                               "MaxAttempts":  3
                                                                           }
                                                            },
                                       "advance_status":  {
                                                              "Policy":  {
                                                                             "MaxAttempts":  1
                                                                         }
                                                          },
                                       "add_ambient_tags_to_story":  {
                                                                         "Policy":  {
                                                                                        "MaxAttempts":  3
                                                                                    }
                                                                     },
                                       "add_fx_tags_to_story":  {
                                                                    "Policy":  {
                                                                                   "MaxAttempts":  3
                                                                               }
                                                                },
                                       "add_music_tags_to_story":  {
                                                                       "Policy":  {
                                                                                      "MaxAttempts":  3
                                                                                  }
                                                                   },
                                       "generate_ambience_audio":  {
                                                                       "Policy":  {
                                                                                      "MaxAttempts":  1
                                                                                  }
                                                                   },
                                       "generate_fx_audio":  {
                                                                 "Policy":  {
                                                                                "MaxAttempts":  1
                                                                            }
                                                             },
                                       "generate_music":  {
                                                              "Policy":  {
                                                                             "MaxAttempts":  1
                                                                         }
                                                          },
                                       "generate_tts_audio":  {
                                                                  "Policy":  {
                                                                                 "MaxAttempts":  1
                                                                             }
                                                              },
                                       "generate_tts_schema":  {
                                                                   "Policy":  {
                                                                                  "MaxAttempts":  1
                                                                              }
                                                               },
                                       "assign_voices":  {
                                                             "Policy":  {
                                                                            "MaxAttempts":  1
                                                                        }
                                                         },
                                       "revise_story":  {
                                                            "Policy":  {
                                                                           "MaxAttempts":  1
                                                                       }
                                                        },
                                       "evaluate_story":  {
                                                              "Policy":  {
                                                                             "MaxAttempts":  3
                                                                         }
                                                          },
                                       "generate_new_serie":  {
                                                                  "Policy":  {
                                                                                 "MaxAttempts":  1
                                                                             }
                                                              },
                                       "generate_character_images":  {
                                                                         "Policy":  {
                                                                                        "MaxAttempts":  1
                                                                                    }
                                                                     },
                                       "generate_character_image":  {
                                                                        "Policy":  {
                                                                                       "MaxAttempts":  1
                                                                                   }
                                                                    },
                                       "log_analyzer":  {
                                                            "Policy":  {
                                                                           "MaxAttempts":  1
                                                                       }
                                                        },
                                       "memory_embedding_worker":  {
                                                                       "Policy":  {
                                                                                      "MaxAttempts":  1
                                                                                  }
                                                                   },
                                       "update_model_stats":  {
                                                                  "Policy":  {
                                                                                 "MaxAttempts":  1
                                                                             }
                                                              },
                                       "auto_idle_attempt":  {
                                                                 "Policy":  {
                                                                                "MaxAttempts":  1
                                                                            }
                                                             },
                                       "test_story_evaluation":  {
                                                                     "Policy":  {
                                                                                    "MaxAttempts":  1
                                                                                }
                                                                 },
                                       "scan_audio_masters":  {
                                                                  "Policy":  {
                                                                                 "MaxAttempts":  1
                                                                             }
                                                              },
                                       "state_delta_builder":  {
                                                                   "Policy":  {
                                                                                  "MaxAttempts":  1
                                                                              }
                                                               },
                                       "continuity_validator":  {
                                                                    "Policy":  {
                                                                                   "MaxAttempts":  3
                                                                               }
                                                                },
                                       "state_updater":  {
                                                             "Policy":  {
                                                                            "MaxAttempts":  1
                                                                        }
                                                         },
                                       "state_compressor":  {
                                                                "Policy":  {
                                                                               "MaxAttempts":  1
                                                                           }
                                                            },
                                       "recap_builder":  {
                                                             "Policy":  {
                                                                            "MaxAttempts":  1
                                                                        }
                                                         },
                                       "create_story":  {
                                                            "ResponseValidation":  {
                                                                                       "EnableChecker":  true,
                                                                                       "MaxRetries":  2,
                                                                                       "AskFailureReasonOnFinalFailure":  true,
                                                                                       "RuleIds":  [
                                                                                                       1,
                                                                                                       2,
                                                                                                       3,
                                                                                                       4
                                                                                                   ]
                                                                                   }
                                                        },
                                       "story/add_voice_tags_to_story":  {
                                                                             "ResponseValidation":  {
                                                                                                        "EnableChecker":  true,
                                                                                                        "MaxRetries":  3,
                                                                                                        "AskFailureReasonOnFinalFailure":  false,
                                                                                                        "RuleIds":  [
                                                                                                                        3
                                                                                                                    ]
                                                                                                    }
                                                                         },
                                       "story/add_ambient_tags_to_story":  {
                                                                               "ResponseValidation":  {
                                                                                                          "EnableChecker":  true,
                                                                                                          "MaxRetries":  3,
                                                                                                          "AskFailureReasonOnFinalFailure":  false,
                                                                                                          "RuleIds":  [
                                                                                                                          3
                                                                                                                      ]
                                                                                                      }
                                                                           },
                                       "response_checker_validation":  {
                                                                           "ResponseValidation":  {
                                                                                                      "EnableChecker":  false,
                                                                                                      "MaxRetries":  0,
                                                                                                      "AskFailureReasonOnFinalFailure":  false
                                                                                                  }
                                                                       },
                                       "response_checker_tool_reminder":  {
                                                                              "ResponseValidation":  {
                                                                                                         "EnableChecker":  false,
                                                                                                         "MaxRetries":  0,
                                                                                                         "AskFailureReasonOnFinalFailure":  false
                                                                                                     }
                                                                          },
                                       "json_score":  {
                                                          "ResponseValidation":  {
                                                                                     "EnableChecker":  false,
                                                                                     "MaxRetries":  0,
                                                                                     "AskFailureReasonOnFinalFailure":  false
                                                                                 }
                                                      },
                                       "test_base":  {
                                                         "ResponseValidation":  {
                                                                                    "EnableChecker":  false,
                                                                                    "MaxRetries":  0,
                                                                                    "AskFailureReasonOnFinalFailure":  false
                                                                                }
                                                     },
                                       "test_music":  {
                                                          "ResponseValidation":  {
                                                                                     "EnableChecker":  false,
                                                                                     "MaxRetries":  0,
                                                                                     "AskFailureReasonOnFinalFailure":  false
                                                                                 }
                                                      },
                                       "thread_chat":  {
                                                           "ResponseValidation":  {
                                                                                      "EnableChecker":  false,
                                                                                      "MaxRetries":  3,
                                                                                      "AskFailureReasonOnFinalFailure":  false
                                                                                  }
                                                       },
                                       "AmbientExpert":  {
                                                             "Tuning":  {
                                                                            "AutolaunchNextCommand":  true,
                                                                            "MinTokensPerChunk":  1000,
                                                                            "MaxTokensPerChunk":  2000,
                                                                            "TargetTokensPerChunk":  1500,
                                                                            "OverlapTokens":  150,
                                                                            "MaxAttemptsPerChunk":  4,
                                                                            "MinAmbientTagsPerChunkRequirement":  2,
                                                                            "DiagnoseOnFinalFailure":  true,
                                                                            "RetryDelayBaseSeconds":  2
                                                                        }
                                                         },
                                       "FxExpert":  {
                                                        "Tuning":  {
                                                                       "AutolaunchNextCommand":  true,
                                                                       "DefaultTargetTokensPerChunk":  900,
                                                                       "DefaultMaxTokensPerChunk":  1400,
                                                                       "MaxAttemptsPerChunk":  4,
                                                                       "MinFxTagsPerChunk":  1,
                                                                       "DiagnoseOnFinalFailure":  true,
                                                                       "RetryDelayBaseSeconds":  2
                                                                   }
                                                    },
                                       "MusicExpert":  {
                                                           "Tuning":  {
                                                                          "AutolaunchNextCommand":  true,
                                                                          "MinTokensPerChunk":  1000,
                                                                          "MaxTokensPerChunk":  2000,
                                                                          "TargetTokensPerChunk":  1500,
                                                                          "OverlapTokens":  150,
                                                                          "MaxAttemptsPerChunk":  4,
                                                                          "MaxMusicTagsPerChunkRequirement":  3,
                                                                          "MinMusicTagsPerChunkRequirement":  1,
                                                                          "DiagnoseOnFinalFailure":  true,
                                                                          "RetryDelayBaseSeconds":  2
                                                                      }
                                                       },
                                       "PlannedStory":  {
                                                            "Tuning":  {
                                                                           "BeatMaxRetries":  4,
                                                                           "MinBeatLengthChars":  500,
                                                                           "RetryDelayMilliseconds":  1000
                                                                       }
                                                        }
                                   }
                 },
    "ToolCalling":  {
                        "Enabled":  false
                    },
    "OpenAI":  {
                   "endpoint":  "https://api.openai.com/v1/responses",
                   "NoTemperatureModels":  [
                                               "gpt-5-nano",
                                               "gpt-4.1-nano",
                                               "gpt-5-mini",
                                               "gpt-4.1-mini"
                                           ],
                   "NoRepeatLastNModels":  [
                                               "gpt-5-nano",
                                               "gpt-4.1-nano",
                                               "gpt-5-mini",
                                               "gpt-4.1-mini"
                                           ],
                   "NoNumPredictModels":  [
                                              "gpt-5-nano",
                                              "gpt-4.1-nano",
                                              "gpt-5-mini",
                                              "gpt-4.1-mini"
                                          ],
                   "NoRepeatPenaltyModels":  [
                                                 "gpt-5-nano",
                                                 "gpt-4.1-nano",
                                                 "gpt-5-mini",
                                                 "gpt-4.1-mini"
                                             ],
                   "NoTopPModels":  [
                                        "gpt-5-nano",
                                        "gpt-4.1-nano",
                                        "gpt-5-mini",
                                        "gpt-4.1-mini"
                                    ],
                   "NoFrequencyPenaltyModels":  [
                                                    "gpt-5-nano",
                                                    "gpt-4.1-nano",
                                                    "gpt-5-mini",
                                                    "gpt-4.1-mini"
                                                ],
                   "NoMaxTokensModels":  [
                                             "gpt-5-nano",
                                             "gpt-4.1-nano",
                                             "gpt-5-mini",
                                             "gpt-4.1-mini"
                                         ],
                   "NoTopKModels":  [
                                        "gpt-5-nano",
                                        "gpt-4.1-nano",
                                        "gpt-5-mini",
                                        "gpt-4.1-mini"
                                    ]
               },
    "Ollama":  {
                   "endpoint":  "http://localhost:11434"
               },
    "Memory":  {
                   "Embeddings":  {
                                      "Model":  "nomic-embed-text:latest",
                                      "BackfillBatchSize":  4,
                                      "RequestTimeoutSeconds":  120,
                                      "EmbeddingDimension":  768,
                                      "SqliteVecExtensionPath":  ""
                                  }
               },
    "AppLog":  {
                   "LogRequestResponse":  true,
                   "OtherLogs":  false,
                   "LogToolResponses":  false
               },
    "CommandDispatcher":  {
                              "MaxParallelCommands":  1
                          },
    "TtsSchemaGeneration":  {
                                "PhraseGapSeconds":  2,
                                "AutolaunchNextCommand":  true,
                                "CharacterExtractionMaxAttempts":  3
                            },
    "StoryTaggingPipeline":  {
                                 "TaggedVoice":  {
                                                     "AutolaunchNextCommand":  true,
                                                     "EnableDialogTagCheck":  true,
                                                     "EnableEmotionTagCheck":  true,
                                                     "MinDistinctCharacters":  2
                                                 },
                                 "TaggedAmbient":  {
                                                       "AutolaunchNextCommand":  true,
                                                       "EnableAmbientTagCheck":  true,
                                                       "MinAmbientTagDensity":  0.05
                                                   },
                                 "TaggedFx":  {
                                                  "AutolaunchNextCommand":  true,
                                                  "EnableFxTagCheck":  true,
                                                  "MinFxTagCount":  3
                                              },
                                 "Tagged":  {
                                                "AutolaunchNextCommand":  true,
                                                "EnableMusicTagCheck":  true,
                                                "MinMusicTagCount":  1
                                            }
                             },
    "StateDrivenStoryGeneration":  {
                                       "EnableDegenerativePunctuationCheck":  true,
                                       "MaxDegenerativePunctuationMatches":  2,
                                       "EnableDialogueLoopCheck":  true,
                                       "EnableEmotionalLoopCheck":  true,
                                       "EnableActionPresenceCheck":  true,
                                       "EnableSimilarSentenceRepetitionCheck":  true,
                                       "SimilarSentenceSimilarityThreshold":  0.8,
                                       "SimilarSentenceRepeatLimit":  2,
                                       "EnableParagraphActionGapCheck":  true,
                                       "ParagraphActionGapThreshold":  2,
                                       "EnableHistoricalLoopDetection":  true,
                                       "HistoricalLoopSimilarityThreshold":  0.85,
                                       "HistoricalLoopRepeatThreshold":  6,
                                       "HistoricalLoopRepeatRatioThreshold":  0.5,
                                       "HistoricalLoopHistorySentenceCount":  5
                                   },
    "NarratorVoice":  {
                          "DefaultVoiceId":  "luca_brasi"
                      },
    "AudioGeneration":  {
                            "Tts":  {
                                        "AutolaunchNextCommand":  true
                                    },
                            "Ambience":  {
                                             "AutolaunchNextCommand":  true
                                         },
                            "Fx":  {
                                       "AutolaunchNextCommand":  true
                                   }
                        },
    "AutomaticOperations":  {
                                "Enabled":  false,
                                "IdleSeconds":  10,
                                "ReviseAndEvaluate":  {
                                                          "Enabled":  true,
                                                          "Priority":  1
                                                      },
                                "EvaluateRevised":  {
                                                        "Enabled":  true,
                                                        "Priority":  2
                                                    },
                                "AutoDeleteLowRated":  {
                                                           "Enabled":  false,
                                                           "Priority":  3,
                                                           "MinAverageScore":  50,
                                                           "MinEvaluations":  2
                                                       },
                                "UpdateModelStats":  {
                                                         "Enabled":  true,
                                                         "Priority":  5
                                                     },
                                "AutoCompleteAudioPipeline":  {
                                                                  "Enabled":  true,
                                                                  "Priority":  8,
                                                                  "MinAverageScore":  60
                                                              },
                                "AutoStateDrivenSeriesEpisode":  {
                                                                     "Enabled":  true,
                                                                     "Priority":  7,
                                                                     "IntervalMinutes":  20,
                                                                     "TargetMinutes":  20,
                                                                     "WordsPerMinute":  150,
                                                                     "WriterAgentId":  52
                                                                 }
                            }
}
